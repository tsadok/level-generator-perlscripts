#!/usr/bin/perl
# -*- cperl -*-

use warnings;
use strict;

# The basic idea here is that we choose a number of seed points at
# random. Each seed point is either wall or open space; each other
# square is either wall or open space depending on the seed point it's
# nearest to. We start with most of the seed points as open space,
# then flip random seed points to walls that have 0 or 1 walls as
# neighbours.

sub min {
    my $x = shift;
    my $y;
    while(defined($y = shift)) {
        $y < $x and $x = $y;
    }
    return $x;

}

sub seedpoints {return 1.17 ** $ARGV[0];}
use constant width => 80;
use constant height => 21;

my @spx;
my @spy;

# Generate seedpoints. (This might put two on top of each other, but
# that's OK; only one of them will be used.)
($spx[$_] = int(rand(width))), ($spy[$_] = int(rand(height)))
    for 0..(seedpoints-1);

# For each square, find the nearest seedpoint. (The outer wall counts
# as a seedpoint of its own; squares nearest to it will always be
# wall.)
my @nearestsp;
for my $x (0..(width-1)) {
    for my $y (0..(height-1)) {
        my $dist = min $x**2, $y**2, (width-$x-1)**2, (height-$y-1)**2;
        my $nsp = -1;
        for my $sp (0..(seedpoints-1)) {
            my $d = ($x - $spx[$sp])**2 + ($y - $spy[$sp])**2;
            $d < $dist and ($nsp = $sp), ($dist = $d);
        }
        $nearestsp[$x][$y] = $nsp;
    }

}

# Determine which seedpoints are adjacent.
my @spadj;
my @toucheswall;
my @adjcount;
for my $x (1..(width-2)) {
    for my $y (1..(height-2)) {
        my $nsp = $nearestsp[$x][$y];
        next if $nsp == -1;
        $toucheswall[$nsp] ||= 0;
        for my $dx (-1..1) {
            for my $dy (-1..1) {
                my $osp = $nearestsp[$x+$dx][$y+$dy];
                ($toucheswall[$nsp] = 1), next if $osp == -1;
                $adjcount[$nsp] += 1 - ($spadj[$nsp][$osp] || 0);
                $spadj[$nsp][$osp] = 1;
                $adjcount[$osp] += 1 - ($spadj[$osp][$nsp] || 0);
                $spadj[$osp][$nsp] = 1;
            }
        }
    }

}

# We start with all seedpoints open.
my @spopen;
$spopen[$_] = 1 for 0..(seedpoints-1);

# Determine which seedpoints are walls.
# Because the seedpoints are randomly arranged anyway, we can pick a
# random seedpoint simply by picking the lowest-numbered.
# Any seedpoint with only one adjacent seedpoint must become a wall to prevent
# the level becoming disconnected.
my $sp = -1;
CLOSEWALLS: while (++$sp < seedpoints) {
    next unless defined $toucheswall[$sp];

    # @adjcount includes the seedpoint itself
    $adjcount[$sp] <= 3 and ($spopen[$sp] = 0), next;

    my $spncount = $toucheswall[$sp];

    !$spopen[$_] and $spadj[$sp][$_] and ++$spncount > 1 and next CLOSEWALLS
        for 0..$sp;

    $spopen[$sp] = 0;

}

# Draw the map.

my ($stonecount, $floorcount) = (0, 0);
for my $y (0..(height-1)) {
    for my $x (0..(width-1)) {
        my $nsp = $nearestsp[$x][$y];
        if ($nsp == -1 || !$spopen[$nsp]) {
            print "#"; ++$stonecount;
        } else {
            print "."; ++$floorcount;
        }
    }
    print "\n";

}
print "Count: $stonecount #, $floorcount .\n";



__DATA__

So writing Perl programs to try out new map generators seems to be all
the rage these days, so I had a go at it myself.

I think pretty much everyone agrees that the endless mazes aren't the
best for Gehennom, so I decided to try my own thing. I wanted to produce
relatively open areas towards the top of Gehennom, because there
aren't enough open levels in the game at the moment, and make the levels
feel more oppressive as you get lower. (I don't think any of the
existing branches, apart from Sokoban, have levels that change in
complexity over time, so that there's an actual feeling of
progression.) I like what Spork's been doing with the Mines level
generator, but felt I could do something better for Gehennom.

So here's a sample Gehennom (with no special levels, doors, stairs, or
similar dungeon features), followed by the Perl script itself. Several
changes need to be done to add this to the game (changing the
pogramming language, of course, but also the algorithm needs a lot of
optimizing). Would you enjoy playing in a dungeon like this?

(Dots are floor, hash signs are walls, because there was no point in
running the wallified_maze algorithm in the Perl script.)

26
###########################################################################­#####
######################################.##.#################################­#####
###......############################....##################################­#####
##.......###########################....###########################.....###­#####
##......####..#####################....####################..............##­#####
##......##........####.....#######.....###################.................­.####
###....#......................###.......########.......#................###­...##
####............................#.......#######.......................#####­#..##
######...................................######................###...######­##.##
######.....................#...............####...............#############­##.##
#######...................##...............####................############­##.##
#######........#######...####..............#####...............############­#..##
##########......#######..####..............#####...............###...####..­....#
############.....###########................####......................##...­...##
############......######.....................####......................#...­...##
##############....####.................................##.....#........#...­..###
###############.....................###..........###############......####.­.####
###################.....##....##########........################....#######­#####
####################...######################..##################..########­#####
###########################################################################­#####
###########################################################################­#####
27
###########################################################################­#####
###########################################################################­#####
##########################...####....######################################­#####
#########################.....##........###########################.....###­#####
##########.....##########...####.........################....######......##­#####
#########........########.########........##############......#####........­..###
########..........#####...#########........#####.#######.......#####.......­...##
#######.....................###..##........###.....#####........#####......­...##
#######......................#....#.................###..........####......­...##
#######.......................#............##.....................####.....­.####
#######..................#########........####.....................####....­#####
######...................##########.......####.....................#####...­#####
#####...........#............######.......#####............#.......#####...­.#.##
####.......######......##.....###.........######.......#####.......#####...­...##
####......#######....#####....#...........######.....######..##.....####...­...##
####......#######....######..............######......#####...#####...##....­.####
###......########.......##....#...###....#####.......####....#####.........­#####
###.....#########....#..##...##.#############........####...######.........­.####
#################...######..#####################...#####..###########.....­.####
###########################################################################­#####
###########################################################################­#####
28
###########################################################################­#####
#################.########################.###############################.­#####
################...#################...##...##############...######..###...­#####
#######.....####....###############..........#....#######............###...­#####
######.......###....#############................####.....####.......###...­#####
######.......##.....#######...##........#.###...####......########...##....­.####
######.............#...................#######.###........###.####....#....­.####
######............##..................########.................###.........­.####
####..............##.................#########..................##.........­..###
###..............###.............#############........................#....­..###
##.........####..###.............############...#####.................##...­..###
##.........#####..##..####........###########..#######.###............###..­..###
##.........#####...#.######........########...############............####.­...##
###........#####.....######.........#####.....###########............#####.­...##
#####......######......#####...................#####.................#####.­...##
#####......######.........##....................###............#......####.­..###
####.......########.......##...#................##............####......#.#­#####
#####.....##########.....###...####.....##.....####.....###########.......#­#####
######...####################..#####...#############...#############...#..#­#####
#########################################################################.#­#####
###########################################################################­#####
29
###########################################################################­#####
###########################################################################­#####
#######......##...############...##########################################­#####
######.............####...####...###......##.....###################....###­#####
######...............#.....###...##....................####.....####....###­#####
######...........................#.........######........#......####....###­#####
######........##.................#........#.#####................###....###­#####
####..........###....####..............####...#####......................##­#####
###...........####...#####.............####.....####...##..................­..###
##..#####.....####...######............####.....####.#####.................­..###
##..#####.....####...######......##....####......##..#####.................­..###
##..#####.....###.....####......####....###..........###########...........­..###
##..#####.....##................####......#...........###########..........­..###
##....###.....#.................####..............###...#########......##..­#####
##.............................#####..............####...######.......###..­.####
##......#.................#....######....#........#####...............###..­.####
##.....##...............####.........#####........####...............####..­..###
##....###.....#........######.......#######.....####.....##..........####..­..###
##########...###...#..########....##########...######...################...­#####
###########.########.####################################################.#­#####
###########################################################################­#####
30
###########################################################################­#####
########.##################################################################­#####
########..###################...############################......#########­#####
########...######.....##.........###############....#######........########­#####
####...##..#######...............####....######.........###...............#­#####
###...........####...........#....##.......###......#...####..............#­#####
###...........####..........###.............##....###...#####.............#­#####
###............###..........#######.............#####...#####.........#####­#####
###.............#...##......###.####..##........#####..####...........#####­#..##
###.................#####....#..#########........####...##....#............­...##
###.................######.......##..####.........##.........##..###.......­#..##
###........####.....######....#.......###.........#..........##..###......#­#####
##.........#####......####...##.......####..................###..###.....##­#####
###.......######.......###...##.......###..................####..###.......­#####
###..##...#######............##..##....................########....#.......­..###
########..#####...............#####..........##........#########....####...­.####
#########..............##......####.........####.......####....##..#####...­.####
#########.........##...###.....####.......#######.....####.........######..­#####
##########..##...####..####...##...################...####....#...#########­#####
##############.############################################################­#####
###########################################################################­#####
31
###########################################################################­#####
#######.###########################################################.#######­#####
##......#####...#####...##############..###...####################...##...#­#####
##......####.....####....######.....#....##...##########...######...####...­#####
###...#####.....#####....................##..###...#####....#####....##...#­#####
###..####.......#####........#..............####....#...###..###......#...#­#####
##...###..##.....###.........##.......#.....###..........##..###.........##­#####
##........###.....#.........###......###....###...........#...##........###­#####
###......####..............#####.....####....#................#.......#####­#..##
####.....####.............######...#######.....##.....................#####­#..##
###.........##.....##....########..######.....###.####.................##..­..###
###...####.####....##...........##..####......###..####..........####......­..###
##....#########....##..........####.###.......###..####......#...##........­...##
##....####.##......##.........................###...##....#####............­...##
###................##..............##...........##..#......####........###.­...##
#####...................#.........###....#.................###........#####­..###
#####.......#.........####....#.######..##...###.....................######­#####
######.....###.##.......#....#########..##..###.......#.......###....######­#####
##############.###.#........##################.......######..##############­#####
##############.####################################.#######################­#####
###########################################################################­#####
32
###########################################################################­#####
#############.##########################################################.##­#####
####...#####..#.###########.....#....####...###...#...##.##############...#­#####
####...####............###............###....###......#..######.######.....­...##
###............##.......##.............#.....####........#####....###......­...##
##...##........###.##...####..............##..####........####..........#..­..###
##..###.........##..##...####....###..######..####...#......#...........###­..###
###..................#...#####...###..####.....###...###......#####.....###­#..##
##.#####.....#####................##.####......###...######...#####.....###­#..##
#..######...#########.............######.......###....#####...#####..#..###­#..##
##.######.....########.....#........####......####....#####..#..###.#....##­#.###
###....##........######..###....##...##......#####....#####.##...#####.....­.####
####..###........######.#####..###...........#####....###...##....#######..­.####
####..###..#..##..####.........###................................###......­.####
####..##...#..##...#......#....###......#..................................­.####
####..#....#.###..........##...###.....###.................................­.####
##.........#.####.........###..........####.............#.......#.....##...­.####
##..#.........##..#...........##........###.......#....###.....###...###...­.####
##.##.....##.....#########...####...##...#################....##########...­#####
###########################################################################­#####
###########################################################################­#####
33
###########################################################################­#####
#######################################################.###.#####.#####.###­#####
#########.##..##################....#####..#...#...#.##.##....###..#....###­#####
###....##..#...#####.....######.....###....................#...##.......##.­..###
###....##..#...#####......#####.....###.......##...........##.....##.....#.­.####
###.....#.....######.......###......###......###...#####..###.....###......­#####
###.........########.......####.........###......######....###...#####....#­#####
##..#.......###............####........#####....####.#............####.....­#####
##.####.....######....####.####........#####....##......#.........####.....­.####
########...#######....###..#####.......#####.##......##.##.................­...##
#####.......#####.....##....###....###.####..##......##.###....##......####­....#
#####..........##....###.....#.....###..###..###....###.###...####.....####­..###
####................####.....#.....###..###..###..#####.##.....####....####­...##
####......##.......#####...........###..###..###..##....####...####....####­...##
#####.....###.....#######..........###...#..####..#......####..###....#####­...##
#####.....####....##............###..........####........###....##....####.­...##
#####......##...............#...###..................#...#............####.­..###
#####......#...#............#...###.................##............#........­..###
############..##...####....###...##..#######...#######...#######..####...##­..###
#############.#########.#.#####.#######################.#########.#########­#####
###########################################################################­#####
34
###########################################################################­#####
####################.######################################################­#####
#####...##..#####.....#####################.......##..#######...#########..­..###
####........#......##..#######....................###..####..........####..­...##
####............####.....#......................#####.....##.........####..­....#
####............####...........#........####.......#......###....##########­#.###
####............###....###.....##..####..###...............###........##..#­#..##
####......#......##...####.....#...####...##...............##..............­#..##
####.....####.........####....##....###..####...###..##.......##.....#.....­..###
####......####........####....###....##..###...####..###..#...###....##....­..###
###......######........###...####..............####..###..##..##.....#...##­#####
######...#######....##........####..###.....#######..##...###.##...####..##­#####
######..####.....#####....#....###...#......#######......#.###.....####..##­#####
#######..........#####...###....##..##...##..######......#.........####..##­#####
###..##..........#####..#####...##.####.###......#..................###...#­#####
###.....#.........###...#####......####.###................................­.####
##.....###....#...###..............###...#...###............#..............­#####
##....###.....##..###...#.........####........##....#####.####.......#...##­#####
##..####..#...###......#####...######....###..###..##############...#######­#####
####################.###############.##.###################################­#####
###########################################################################­#####
35
###########################################################################­#####
#################.##############..####.###############.####################­#####
#####......#...##..##.##....##.##...#..###.....###....#######..############­#####
###............##......###.....###.....##...................#..###..##.....­.####
###.#..#..#.....#..........##..###...........##.....###........##..###.....­.####
###.####..##.............#####.##............##.....#######...###.####.....­..###
###.#.###.###.........###...#................##.....#.#######.###..####....­..###
##........###........####.........##.........###..........##...#...####....­.####
###.......#...........#.#..##...####.....########.........##.......###.....­.####
#####.....................###..####.....###.####...#####......#....##......­#####
####....###..............####...#####..####..###...#####....####...........­.####
###.....###......####....####......###.......##......###.....###..#....###.­...##
##....#..###......########..........#.....#####......###......##.##....###.­...##
#....##..###.......#######.....##.............................#####...####.­...##
##..###..###........##.####..####........#####...............####.....####.­.####
###.....####..................##....###..#####....#.........#####..#######.­#####
####.....###............#.........######..........###....##..####..###.....­.####
#####...............#...###.......###.#..........####...###................­...##
#####..#.....####..###..###...#...###....#####...####...###...##.....##...#­...##
############################.###############################.#####.########­##.##
###########################################################################­#####
36
###########################################################################­#####
####################################.#######.##########################.###­#####
###...#########....################..#....##...##........####..###..###....­.####
###...#####........##........#.......#..#.###.###..........###.......###...­....#
###..######...##........#.........##...##.###..###....##.............####..­....#
###.#######..###..##...###.......###...##..#.........####..##........####.#­##.##
###..####...####..###.######....####......##..........##...###.......###..#­##.##
###............#.....#######.....####.#...####..###...##....#####.........#­#..##
##.........#.............#...###..###.##..###...#####.......#####....####..­...##
##..##....##.............#...###...######........###....#...#####...####...­...##
##..##...###...#.....##..###..###....###.....###..#.....##........#..###...­#####
##..###..####.###...####.###..###....##.....###...########.......##...#.#..­#####
###..###......####...###............#####...##......######........#........­.####
###...#.......#####....#............#######.............###...###......##..­##.##
#.........#...#####......#...........###......................#####...###..­##.##
##.......#########.......###....##....#.............##......#..####...####.­##.##
##.......####..##...##...##..#..###.................##..#..##...##....###..­....#
##..###..###........##......##...##..####..####.........#####.........##...­.####
##########....#...#...####..##.......##########...#........###..##...######­#####
############.#######.###########.##.#######################################­#####
###########################################################################­#####
37
###########################################################################­#####
##################..############################.################.#########­#####
###..###.....##..##..#....######......###....###....####...#....##...#.###.­.####
###..###..#####.####.##.......#...#####.......##..#.####.........#.........­.####
###..##...##....####...##.......######............##.###....##.......#.....­...##
###.............####....#......####.#......#......##..###....#...#####.....­..###
####..............#.......#####........#######...##..####..#....######.#...­...##
####.......###....#####....####........##.####....##.###...#########...##..­...##
#####.##...###....######...###..............###..............##........###.­....#
#####.###.........####......#....####.............####......###...#.....###­...##
##.#...##....##..................####....###.......####..##..#...###....###­..###
##......##..####..####............###.#.#######.......##.###.....###.....#.­..###
###....#########...####.####...#...####..#..#######.......####...##...####.­...##
###...####.#####...####..###...#....###.....###.###........####..##...#####­...##
###...###......##........###..##.....#......##...#..####...#####......###..­...##
###...............#....#....####....#............#..#.##...##.#............­#####
##..........###..###..###..........##.........#.......#....#...............­#####
##..#.......####.##...####......#.....##.#...###.............##..#...##....­.####
#########...#####......########.#...#.##.######...#########..###.###.##..##­#####
###############################.#.#############..###########.###.####.#.###­#####
###########################################################################­#####
38
###########################################################################­#####
#########################.####.########.##.################################­#####
###.....##...##...#..#....##.......#........#.###.###.........###....##..##­#####
#####.......###.#.#...........##........##..#.#....##..#......###....#....#­#..##
##..#........#.............#.###...#######............####....####.#....#.#­#..##
##........#.............#.....##.......###....#####....###.#..###..##...#..­#...#
##.......####..####....####...##...#...###....#####.###............##...#..­##.##
##..##....###..#####...####...#...####.##........#...##.......###..#....##.­#..##
###.##....###...........#.....##.#####..........###.........#.###..##.#.##.­#..##
##..#..##..##......#....##....#...####...###......##...###.....##.###..###.­...##
##.###..#....###..###...#..#..........##.###...#####.######.###.....#......­...##
##..##..##..####..###......##...####.###.##....####..##..##.##.............­#####
##..##.......###.####...#.###...####..##.......##........#...#...##.......#­#####
###...###....###.###......###....###......##...##..#........##.....####..#.­...##
###....####.##....#..##..#.#......#....#..###..##..####....###..##.###...#.­...##
###.....##..##.......#..###..#........###..#..##...####..#..#.....###....#.­#####
###.........##.......#..###..##......#####.#..##...###..###.#......#.......­##.##
#####........#...........#.........##....................#.###..#..........­...##
###########.....####......##..##..####..#.#..###................##..####..#­....#
#############.##########.##############.###.#################.####.########­#.###
###########################################################################­#####
39
###########################################################################­#####
######..#.############.############################.#######.#####.#########­#####
####.#..#.....##.....#.#####........####...#...###..#.....#.....#.###.###..­.####
###..#..##....##.......###...........#.........###................##..###..­...##
###..#......#...............###..##.........####........#..##.##......###..­....#
####.....#.##....##..###....###.#####.......####..#..##.#.....###...#..####­#..##
####.#..##....#.####.......###...####...##..##....#..##.##.....###.###.....­...##
###..####....##.###.#.......#........######.##.#####.##.#.###...###..##...#­#.###
#....##.##...##.....####............###.##......##.#.##..####...###..#....#­#.###
#....##.##..#...#...#..........#.#####...............##....###..###.....##.­...##
###..##..#####...#.....###....##.#.###....###....###.##...##....#......####­...##
##....#..#.###..##....######........#...######....##.....###..#.......#####­...##
#..##.......##..###..#########..#####..###.##..#..............###......#.##­#..##
#####.#.##..#......#.####...##..#.##...###.#...##........###...###...#...##­#..##
####..#.###...###.....##...####.......###..#...##...##...###....##.####...#­.#.##
##....#.#....#.##.........###.....#........#..###..###...##...###...###....­.#.##
###.........##..#.##..##.........####.####....###..###..#.##..###..........­.#.##
##.......##.##.....#..###........##.....##.....#....##.##......##.......###­...##
##..#..#.##.....##..........##..##...###..................###......##...###­...##
###############.#########.####.#########.######.#####.#.#.################.­#####
###########################################################################­#####
40
###########################################################################­#####
########..####.#######.#####.#############.##.#..#########.#.##############­#####
##.....##..##........#.##.....###.............##....#...##........#..###...­.####
##.....#......##.......#....#.####......##....##.#..#....####.....#..###..#­..###
###....##.....##..#.#......##...###....####......#..###....##..#...#..#..#.­...##
#......###.....#.##.##....###..........##.....#####.........#..#...#.##.##.­#..##
#####...##.##.....####..#..........###.......#####.......#.###.###.#....###­#..##
####...........#..###..##....#......##.......###.....##..#####..##...#.....­#.###
###...#####...##.........#..####....###.##.#####..##.##..###....#....###...­...##
##....##..##..####.......#..#######..#####..###...##.###........#..........­..###
##........###..#............##...##...#####.......##..#...####.###.####....­..###
##....##.###...##..###........##......#........#...##...######.##..##....##­...##
####..##.......##..###..#.....###..........##.##...##..###.....#...##...###­...##
###...###..#..#....##...###....#............#..#.###........##....###...###­...##
##.....#####.##....##...###....#.###......#....#..#....#....#.###.###...##.­...##
###.....##.#.##....##...##....##.###...#######......#..##...#.#........##..­##.##
#........#....#..#...............##......#........#.##...........##...###..­#####
###.............###......###.....##.............###..##..........###...#...­...##
##....##........##.............#..##.#.#....##..###..##..####.....#..#.....­##..#
##############.######.##########..##.#.########.############..##.######.###­#####
###########################################################################­#####
41
###########################################################################­#####
##########################.####.##############.####.##.########.######.#.##­..###
##.#.###...###......##..##..###.#.##..####...#..###.##....##.##.####.....##­..###
##....#.#..##...........###...#...#..............##......##...#.##.........­...##
##.#...###....###..####..##......##.###......##..###..##.##.....#...#.##...­##.##
##.#.#......#..##..###...............####...####..##..##.....#.....####..##­#...#
#..###...#.###.##...#.......##...##...####.#.#........#####..#....##......#­...##
#...##..##........#.#..##...##...###...#####..........##.#..##..#....#..#..­#####
##........#####...#...####...###..##.......#...###.##.......###..#.#######.­#####
##.......####...###..#####...####..##...#......#..###....##...##.##.##..##.­.####
##..####.......####.###.....#####......###.#......###....##.#.##.##....###.­....#
##..####.............................#.#####.##.#..#......#.#.....##.......­....#
##...#..##.....####.#.#...##....###..#....##..#..#....##....#...#.....##..#­##..#
##...#..####....#####.##..###......#.###..##..##......####.....###....#...#­#..##
##..##..#####.....##..##..###.....###.#..###..##..#.....##..###....##.#...#­#..##
##.....##..#...###...##....#....#.##.....##...#...#......#.#####..####.....­#..##
##......#....#........#....###.##....#...##......###....#.....#....###....#­#..##
###..#......##..###......#..#...#...##...............#..#.............###.#­...##
###.###....###.#####...###........#..#.##..##....#...#....#..##........##..­.####
####.####################################.##########.######.###############­.####
###########################################################################­#####
42
###########################################################################­#####
###################.##################.#..##.#.######.########..####...#.##­#####
#....####.##..###..#........##..#...##..#....#..####...###.##........#.#...­..###
#.#........#..##...##..##...........##..#..#........#..##....###....##.##..­..###
#..#.......#....#......##....#...#..................#........###...###....#­#..##
##.###..........##.##..###.##.##.###.#.###.....#....##.......##..#.###.##..­.#.##
##..#..###.........#.......##..#.###.#.###.########.##..##...##.##.###.##..­###.#
##.....###.####..#.#.##..#.......###.#...#...#######...###.......#.##..#..#­.##.#
##..##..#..##....#..###..#.....#..#......###...........###................#­....#
###..#..#..##..####.##....####.##.#..#...###..####....###....#..###.##..#..­...##
##.....##..##.......##.######..##.#.###....#...#..#...##....##..#...##.####­#...#
###..#........#.###.............#.#..#...#.##..............###..###.#..##..­#.#.#
##...##.......#..#..##.###..##........##.####..##..#...#.##.##............#­#.###
##...#..######..#..##..###....##....#..........##..##....##..#####...##...#­#.###
####.#...##..#..##......#..#.###...###.###.....###.####..#..####...#..#....­...##
####.##......#.##..#.###..##.##.....##......##......##.....#####..###.#..##­..###
###..##...##.#.....#..#..##......#.....#.##.#.##.##.##..##.......#.##.####.­...##
###.......##...###.##...####....###...#####...#..##.#...####...............­...##
###.###......#.###.##.#.......#.....#....................#.....##.#..#..#..­...##
###.#################.#.#.#####.#######.##.#######.################.#######­#####
###########################################################################­#####
43
###########################################################################­#####
##..######.#########.############.######################.####..########..##­#####
###.......#.............###....................#.##....#...###..........##.­...##
##...#....#.......##.........###.#...#......#....###.....#####...##.##..###­#.###
##..####.....##...###.###.##.#.####.###.###.#..#..#####..#.......#..##.....­...##
##.##........####..##..##.##...#.##...#.##...###..##.###.#.###.#..#.##..#..­#..##
##.##...###..#####......#.#...............##..#..........#.#.#.##.#..#.###.­##.##
#..##...##.#...#####..#.#.#####..##....##.......####.##......###.....#..#..­...##
##....###..#.....###.##.#.#.##..###..#....##.##.#..#.#....##......#..#.....­##..#
#......###....##......#..........##.####..##......##.#...###.###.#####..##.­#..##
##.##....#...####..##.#...####..#####.##..###.##...#.#..#........##....#..#­##..#
##.###......##..#.###...####.##....##.##...#...#.......##....#.............­...##
###..........#.##..#.#.####....##..##.#.........##...#.##.##.#####..###.##.­##.##
#...#..##.##........#######..#...........##..#####..##....##..##....##.....­##.##
###.#####.##.##..#...#.......#...##...##.##..##.......##...#.......###.....­..###
###.#.##...#.#..##............##.#..#.##.##.....##..#.###..#.....#..#..####­....#
##..#..###..#...##.###..####...#.#..#.......##.##..##....#.#..##.##...###..­..###
#...#......##...###.###.....##...##...#.....##........##.#....##.##.#..#...­..###
#.#....#.#.....####..................###....###.......##......##.##.#.....#­..###
#######.###########.####.##.######.##...#.###########.######.#######.######­#####
###########################################################################­#####
44
###########################################################################­#####
###..###.#..#####..#####.###.#####.#####.######...#####..#######..#######.#­#####
##...........##...##.##..#.#.##..........#...#..##.............#..........#­...##
##.##....#.#.#..#..#..............#####.....##...#.#.#..#.##.....##..#...##­.####
##.##....###...###...######.#..##...##....####.....####.#.##....###..###.##­.#..#
#..##.##...###.........#.#..#.###...#..#...###..#..#.#..#....##....#.#.#...­...##
#..#..##..#....##..###........#....#...###..##.#####...##.##.##....#....##.­.#..#
#.##....#....#.##..###.###.......###.#...##.....#.#.#..##.##......##.####..­.##.#
#..##..#####.#..##.###..#...##...###.##.###..#.........##..#...#......##...­##..#
##.....#####...###...#....#.##...#...#...#..#..##.#..........#.####.##....#­##.##
#####..........###.##...#.#####............##..#####...........##...#.#....­.#..#
##.#..#...###.......##.##.#..####..###.###..#..##..#.#.....###..###...#..##­...##
##.#.###.##......##............###.###..##..##.#...#.#####.####.........###­....#
##...###...#..#.....#...###.#...........##.#.#........####.#.##.#.#..##...#­#.###
#.....#....#.###...####..#..###.##..#...#..#..#..##........#.....###.#..###­..###
###.#..##....#####..#.##.#..#.......##.###......####..#....##..####...#....­#..##
#####.###.............##......##.#..##.......##.##....##.......#......####.­..###
##..#.##.#...#####.#.###...#.....#...##.###.##.......###.###.###..##..#..#.­#####
##.................#.....###.##.###..#...#...............###.......##.#....­....#
####.#.####.##.####..#######.###.###.####.##.#####.####..############....##­#####
###########################################################################­#####
45
###########################################################################­#####
########.####.#.###.###########...#...######...######..######.####.######.#­.#.##
##.#.................###.#......#...#.##.....##.#..#..#....#..##.#..#..##..­....#
##......###..#.....#..#....##.####.##.##.###..#.#....###.......#.......##..­..###
##..##...##.##.##..##..##...#...##.##.................##..#.#......##.....#­#..##
##..#..#....##...#.#....#.#.##..........##.#..##..##......#.##.#...##.....#­##.##
#..##..##.#####..........##..#.##.....#..#.##....##...#.###....#.#####....#­#..##
##..#...........#.#####.#.#.##.###..#.#.......#.#.#..##.#.##.#.#.#......#.#­#..##
##..###.###...###.#...#........##...#..##.##.#..#.#..........#.......##..##­#.###
##.#..#..#..............####.#....#....###.#.#.....#.###.##..#.#..#...#...#­.####
##.#.......#...#....###........####.#..#.##.....##...#.#.###...#######...#.­..###
##..##....##..#.##..###.##.##.###.#.#..#.#....#.##.......##..#...##.##.....­...##
#..###.#..##..#.........#####.###.........#.#.......##..#...#..........###.­...##
#...#..###.##...##.##.###.......##...#.##..###..##...##.#.#####.......###..­##.##
##.......#..#..###..#......#####..#.##.#.........#........#.....##....##..#­##.##
##...###.#......#..##..#...#..#......###.#.##.##.#.#..#..###....##..#....##­#..##
####.###.....##...##..###.....#.#####......##.....###.##..#..#.##...#..#...­...##
###........#####.....##.##.#...........#...####....#..###.#.##.##.####.#..#­#.###
###........###...##..##.....##.....#.#...#..#...##...........#..........#.#­#..##
######.#.####..#.###.##.###...####.#######....#.##.#######.#.#.#.##.#.#...#­..###
###########################################################################­#####
46
###########################################################################­#####
##.##.##..####.#####.#...###....##########..###.##..####..#..####.#...##.##­#####
##.......##..#.##.###..#.#...##.#......#.......#...##..##.#.##.##..........­...##
##..#.##........#..##......####.##.###.###..##.##..##..##....#....##.##.###­.#.##
#..####.#.###.#........###.###...#.#.#...#..##.........###.#...#.##......#.­.#.##
##.##...#..##.#...###..#....##.#.#.#.#.#........##.#......##..##....#..#...­.#.##
#...........#.###..##.......##.#.......#.##..##..#.####.#..#...##.####.#.##­.#.##
##..#..##.#.#.......#.##.#...#.....#......##.#..#.......##...###..#.###..##­...##
###.....#.....###.#.#.####.###...####..##.#....#.##..##.#..#..#..#..##.....­..###
###..#..#......#..#.#....#.........#..##..#.##....##..#.#.##....##.....####­#.###
###.###.##..#..#..#.#....#.##.##.##....#....##.#..##.#.....#.#.....##......­#..##
#....#.......#.#..#...#.##....##..#......###..###....#.##....##....##..###.­....#
###..#.##..#.#.#.##..#####.#......#..###...#.###..##.#..###.###.....##..#..­###.#
####.#.###.##.....#...#......#.##...##...###..#.........#.....#.###........­....#
##...#.#....#..##.#.#.#.##.###....#.###...........#.#......##.#.###.####..#­##.##
##.#.....##.#..#........#..##..###..#.#....###.#.#..#.....#...............#­...##
#..##.##..#...##.##.#.#.#..#...#.##...#.#.##.....##.#.##.##.#.####....###..­.#.##
##..#.##.....#.#.....##.......##.#.#....#.##..###...#.##.##.....#...#...##.­.#..#
##..#.....#.............#............#......#...............#.....#.##....#­.####
###..####.####.#####.#.########.######.##.###############.###.#####..####..­.####
###########################################################################­#####
47
###########################################################################­#####
############.#######....##...#.##.####....#..#....#.....######.#..###.#.###­#####
###......##.......#.###....#.#.........#..#.....#.#..##.....##.#.##.#.#.#..­...##
##..###..#.....#.....##.#.....#.###.##.##...##..#.#.#.#.###......##.......#­.#.##
#.##.......###.#..#.......###.#.#...#..#..#.##.##...#.#.##..####....#####.#­.#.##
#......##..##....##.#..##..##....##.##............#.....#.....#...#....#..#­.#.##
##..###......###.#.##.####.....#..#.#..##.#.##.##..#.#.####.##.....###...##­.#..#
#..###......##.............##.###...#.###.##......###........#.####.##.#.##­...##
##....##.#...#.#..##.##.##......#...#......#.#...#.#...###.#...####........­..###
##.##.##.##.......#..##.####..##.##.#..##....#.####..##....###......##.#..#­.####
##..#..#.#..#.#.#.#.....#..##.......#.#...####.##.#..##.#...#.#..##.##..#.#­#.#.#
#..###.#...##.##..##.#......##.##..##......#.........##..#.##...##..#.#.#.#­....#
##.......###....#.##.#.#...#...#.......###....#.#.##..#..#....#.#.....#...#­.####
###..#.#......#.#.#..#.##.##.##..#####......#.#...#......##.##.....#....#..­.####
#.......###...#........#...#.##...#.##.###.######.##.###.#......####.###..#­...##
##.#.##.##.##.#.#.####..........#...#..............#..###...#.#....#.#....#­..###
#.##.#.....#...##...#######.##.###....##.#.#............#.#.####.#..####.##­#..##
#....#.###.#.#..#.##..#........##..##.##.#.###.#...##...###..##..........#.­..#.#
#.#.#...#....#..........#..##.##..##.....#.....#.###..#.........###.#.#....­..#.#
###...######..##..#.###..###.....##..#.###.###......#...###..##..#..#.#.###­#####
###########################################################################­#####
48
###########################################################################­#####
#######..####..#.#.###.#..#.######.#..#.###..#.......#.##.#..#...####...##.­...##
####...#....#..#.......#.##....#...#........##.#.##.#.....##.#.##.....#....­##..#
#.##..##.#....#..###.#....#.##.#.###...####....#.##.#..##.........#.#......­.#.##
#.....##.###.##.##...###....#....##.##.#....#.........#.#.##.#.##.#.##.#.##­.####
##..#............##...###.#..#.#.....#...##.##..#####...........#......#.##­...##
#..##.##.#.##.#.....#.....#....##........#....##.......##.##.##..####..#.#.­##.##
#..##...##..#.#.#.#.##..#.####....##.#.#..##...#.#.#..##...#..#.###....#.#.­#..##
##.......#....#.#....##...##..###..##..#.....#.....##......##.#.#.##.#...#.­.#.##
#....#.#.#.####..#......#....#.#..........#..####..###..........#....#.##..­....#
##...#.#.#.##...##...#.##.........#.##.#.#...##.#.#......##.##.....#......#­##.##
####.#.#......#...##.#....#.#.#.#.#.##.#....##....#..######.##.#.#...####..­##..#
###...###.#.....#.##....#.#..##.#........##..#.##......#.....#.#.#.#...#...­.#.##
#...##.#..###...#....#..#.##.##.....###...#.......#......###.#.#...#.#.####­...##
##......#...#.#....###...........##..####.####.######.##...#.....##..#...#.­...##
#..###......#..#.....#.##.##....###....#...###.#......#..##..##.##..#..#...­.####
##..##.##.#...#..##..#....#..##.#...##...#.....#.###.##..#..##.....##..###.­#...#
##....##..#......#..##.###...#....#.....##.##..........#.#..........##.##..­...##
###.#.......#.#..##.....#..#.#.##.#.###..#....##.#..##........###.........#­#..##
#####.#..#..#.##.#####.#.....#.###....#....####...###..##.###.....####.##..­.####
###########################################################################­#####
49
###########################################################################­#####
###.###.#.####.#..#.#.####.##.#..####.###.#.####....#.##...#.##.#.#..#....#­.#..#
##....#.#.#.........#...........#................##.....##......#....#.###.­.#.##
#...#........#..#.#...##.#..###...#####.#..##..##.#..#.....##.....##.....#.­....#
##.#...##..#.#..#.###..#.#.#....#...#...##..##.....#.##.#.#..##.####.#.#.#.­#.###
##.###....##.#......#...#.....#.##.#..#.#....##.#...#.....#.##........##...­....#
#..###.#.......#.##....##.##.##....#.#....##.#.#..###.###......#.##.##.#.##­.##.#
##.....##.##.#.#..#.#....#.....##.###....#.......#......###.##.#...........­.#..#
##.#....##.#.#......####.##.##.#.......#..#...##..#.#.##....##..#..##.##.#.­...##
#....#..##.....##.#......##...#..#..##.#.#..#.###...#....##...#.##.#......#­....#
#.##.##....###..#..##........#...##..#.#.#..#.....##..##.#...##......#..#.#­...##
#...............#.####.#.##.##.#....#.....##.#.##...#..#.........#.###..#..­##..#
##.#.##.#.##.##....#...#...#.#.##.#.#.##..............###.#..#.##....#.##..­...##
##.#....#.##..#.#.#..###.###...#.........###.#.#.#.####...#.#..##.##.......­##..#
#..#.###.....##.#.....#......#...##.####.....#.#.#.#.#..#...#.#.#....#.###.­#...#
##.#.....##.....##.#....#......#.##...#..##..##..#.#....###.....####.#.#...­#.###
#..#..##.####.#.....#...#.##.###...##............#...#......#.#..#.#.#..##.­....#
#.....#..#.##...#.#...#.#....#........##.#.#.##.##.######.#.#.#.........##.­##.##
####.##.......##.....##...##...#.##....#.#.#.#.......#....#...##.#.##......­....#
##.......##.#..#.########...##.#...#.#..#...#.###.###..#..#.#....#..#.##.##­#.###
###########################################################################­#####
50
###########################################################################­#####
##.###.##.#.#.##..#.######..#.##.....#####..#....###..###...###.#.#..#.#.##­.####
#....#........##..#.#....##.#....#.#....##..##.#.....#....#.....#..........­....#
#.#.....##..#.##..#...##..#...##.#..#.#....#...#.##.#.##.##...#.#.##.##.###­#.#.#
#.#...###..#..##.#....##..#.#.##......#..#....##...........#.#.....#.#..#..­..#.#
#####.#.#...#.......#.......#...#.###.##.#..#...#....#.#.##.#..#.##......##­#.#.#
#..#..#....#.#.#.#.###..##.#......#.......#.##.##.#.##.#....#.##...####..#.­....#
##....#..#.......#..#..#...#.####.#.##.#........#.##.....##...#..#.........­.#.##
##.#.#..#..##.##.#.#.#...#.#..#...#....#..#..##..#...####..#.##....#.#.#.#.­.#..#
##.#......###......#...##...........##.##.#.###...##.......##...##.#..#...#­.##.#
#..#.#.#.....##.#...#.....##..#.#................##....#.#.##.#....##..#...­.#..#
#.##..##.#......#.##..####...#....#.####.###.##....#.#...#...#...##......##­....#
#.##.........#......#......#..#.#.#......#.#....#..#.###.##..#.###..#.#..##­##.##
#....###.#.#..#..##......##...#.#.#.#.#..#....##.#.#.#..............#.###..­....#
##.#.....#.#..##.####.##.####.#.#.#..###....#.##.#.#.#.#.####.#.###.##....#­#.###
##.#.#####.#.#.....#...#....#.#...#.#..#.##.#.#..#.....#.#....#..#.....#...­....#
#...............#....#....#.....#.....##.##.#.#....#..#..#..#..#....#.##.##­#.###
#####.###.#.#.###.##.###.#..###.#.#.#.....#.#.####.##..#....##...#...#.....­....#
#.....................#.....#.....#....##........#.......##....#...##.#...#­.#.##
##.#.#########.#.#####...##...#.##..#####.#.#.#....####...#####.##......##.­.#.##
###########################################################################­#####


